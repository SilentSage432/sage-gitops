apiVersion: apps/v1
kind: Deployment
metadata:
  name: epsilon-ui
  namespace: arc-epsilon
spec:
  replicas: 1
  selector:
    matchLabels: { app: epsilon-ui }
  template:
    metadata:
      labels: { app: epsilon-ui }
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 101
        runAsGroup: 101
        seccompProfile: { type: RuntimeDefault }
      containers:
      - name: nginx
        image: nginx:1.27-alpine
        ports: [ { containerPort: 80, name: http } ]
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          capabilities: { drop: ["ALL"] }
        volumeMounts:
          - { name: html,  mountPath: /usr/share/nginx/html, readOnly: true }
          - { name: theme, mountPath: /usr/share/nginx/html/theme, readOnly: true }
      nodeSelector: { kubernetes.io/os: linux }
      tolerations:
        - { key: "node-role.kubernetes.io/control-plane", operator: "Exists", effect: "NoSchedule" }
      volumes:
        - name: html
          configMap:
            name: epsilon-ui
            items: [ { key: index.html, path: index.html } ]
        - name: theme
          configMap:
            name: epsilon-theme
            items: [ { key: theme.css, path: theme.css } ]
